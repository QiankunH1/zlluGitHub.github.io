(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{505:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"创建管理员账户并赋予权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建管理员账户并赋予权限"}},[s._v("#")]),s._v(" 创建管理员账户并赋予权限")]),s._v(" "),a("p",[s._v("打开 cmd 或 Xshell，进入到 mongo 的 bin 目录下，输入命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入数据库")]),s._v("\n./mongo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入admin数据库，成功会显示：switched to db admin")]),s._v("\nuse admin \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置用户名密码")]),s._v("\ndb.createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("user: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"用户名"')]),s._v(",pwd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"密码"')]),s._v(",roles: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" role: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v(", db: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("用户添加成功后会出现成功的字样和添加的用户信息。然后执行：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("db.auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'用户名'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'密码'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("若返回 “1” 则代表设置成功。")]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),a("p",[s._v("帐号是跟着库走的，所以在指定库里授权，必须也在指定库里验证(auth)。")])]),s._v(" "),a("h2",{attrs:{id:"给自定义数据库设置权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#给自定义数据库设置权限"}},[s._v("#")]),s._v(" 给自定义数据库设置权限")]),s._v(" "),a("p",[s._v("例如我们新建了一个 test 数据库，设置账号：'adminDb'，密码：'123456':")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("use "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\ndb.createUser"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("user: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"adminDb"')]),s._v(",pwd: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123456"')]),s._v(",roles: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" role: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"readWrite"')]),s._v(", db: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndb.auth"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'adminDb'")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#若返回 “1” 则代表设置成功。")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("进入 "),a("a",{attrs:{href:"http://zhenglinglu.cn/mongodb/mongodb_az/#_4%E3%80%81%E7%BC%96%E8%BE%91-mongodb-conf-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6",target:"_blank",rel:"noopener noreferrer"}},[s._v("mongodb.conf"),a("OutboundLink")],1),s._v(" 这个配置文件，添加：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("auth "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("保存文件，"),a("a",{attrs:{href:"http://zhenglinglu.cn/mongodb/mongodb_az/#_5%E3%80%81%E5%90%AF%E5%8A%A8%E6%88%96%E5%85%B3%E9%97%AD%E6%9C%8D%E5%8A%A1",target:"_blank",rel:"noopener noreferrer"}},[s._v("重启 mongodb 服务"),a("OutboundLink")],1),s._v("即可。")]),s._v(" "),a("h2",{attrs:{id:"用户角色列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户角色列表"}},[s._v("#")]),s._v(" 用户角色列表")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Read")]),s._v("：允许用户读取指定数据库")]),s._v(" "),a("li",[a("code",[s._v("readWrite")]),s._v("：允许用户读写指定数据库")]),s._v(" "),a("li",[a("code",[s._v("dbAdmin")]),s._v("：允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile")]),s._v(" "),a("li",[a("code",[s._v("userAdmin")]),s._v("：允许用户向system.users集合写入，可以找指定数据库里创建、删除和管理用户")]),s._v(" "),a("li",[a("code",[s._v("clusterAdmin")]),s._v("：只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限。")]),s._v(" "),a("li",[a("code",[s._v("readAnyDatabase")]),s._v("：只在admin数据库中可用，赋予用户所有数据库的读权限")]),s._v(" "),a("li",[a("code",[s._v("readWriteAnyDatabase")]),s._v("：只在admin数据库中可用，赋予用户所有数据库的读写权限")]),s._v(" "),a("li",[a("code",[s._v("userAdminAnyDatabase")]),s._v("：只在admin数据库中可用，赋予用户所有数据库的userAdmin权限")]),s._v(" "),a("li",[a("code",[s._v("dbAdminAnyDatabase")]),s._v("：只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限。")]),s._v(" "),a("li",[a("code",[s._v("root")]),s._v("：只在admin数据库中可用。超级账号，超级权限。")])]),s._v(" "),a("h2",{attrs:{id:"内置角色"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内置角色"}},[s._v("#")]),s._v(" 内置角色")]),s._v(" "),a("ol",[a("li",[s._v("数据库用户角色："),a("code",[s._v("read")]),s._v("、"),a("code",[s._v("readWrite")]),s._v(";")]),s._v(" "),a("li",[s._v("数据库管理角色："),a("code",[s._v("dbAdmin")]),s._v("、"),a("code",[s._v("dbOwner")]),s._v("、"),a("code",[s._v("userAdmin")]),s._v(";")]),s._v(" "),a("li",[s._v("集群管理角色："),a("code",[s._v("clusterAdmin")]),s._v("、"),a("code",[s._v("clusterManager")]),s._v("、"),a("code",[s._v("clusterMonitor")]),s._v("、"),a("code",[s._v("hostManager")]),s._v(";")]),s._v(" "),a("li",[s._v("备份恢复角色："),a("code",[s._v("backup")]),s._v("、"),a("code",[s._v("restore")]),s._v(";")]),s._v(" "),a("li",[s._v("所有数据库角色："),a("code",[s._v("readAnyDatabase")]),s._v("、"),a("code",[s._v("readWriteAnyDatabase")]),s._v("、"),a("code",[s._v("userAdminAnyDatabase")]),s._v("、"),a("code",[s._v("dbAdminAnyDatabase")]),s._v(";")]),s._v(" "),a("li",[s._v("超级用户角色："),a("code",[s._v("root")]),s._v(";")]),s._v(" "),a("li",[s._v("内部角色："),a("code",[s._v("__system")]),s._v(";\n这里还有几个角色间接或直接提供了系统超级用户的访问（"),a("code",[s._v("dbOwner")]),s._v(" 、"),a("code",[s._v("userAdmin")]),s._v("、"),a("code",[s._v("userAdminAnyDatabase")]),s._v("）;")])]),s._v(" "),a("h2",{attrs:{id:"数据库操作相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库操作相关命令"}},[s._v("#")]),s._v(" 数据库操作相关命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mongodb 进程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ef")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mongodb\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看数据已存在的数据库")]),s._v("\nshow dbs\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入数据库")]),s._v("\nuse "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("数据库名称"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前数据库下的所有用户")]),s._v("\nshow "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前数据库中的数据表")]),s._v("\nshow tables\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);